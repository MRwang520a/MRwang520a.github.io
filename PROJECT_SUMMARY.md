# AI åœ–åƒè™•ç†å¹³å° - å°ˆæ¡ˆç¸½çµ

## ğŸ“‹ å°ˆæ¡ˆæ¦‚è¿°

ç‚º `mrwang520a.github.io` ç¶²ç«™å»ºç«‹å…­å€‹ AI åŠŸèƒ½æ¨¡çµ„çš„å®Œæ•´å‰å¾Œç«¯è§£æ±ºæ–¹æ¡ˆã€‚

### å…­å¤§ AI åŠŸèƒ½

1. **AI è¬ç‰©æ‘³åœ–** - æ™ºèƒ½è­˜åˆ¥ä¸¦åˆ†é›¢ä¸»é«”èˆ‡èƒŒæ™¯
2. **AI ç”¢å“ç²¾ä¿®** - è‡ªå‹•å„ªåŒ–å…‰å½±èˆ‡ç´°ç¯€
3. **AI èƒŒæ™¯åˆæˆ** - æ™ºèƒ½ç”Ÿæˆç²¾ç¾èƒŒæ™¯
4. **AI è¨­è¨ˆå¸«** - ä¸€å¥è©±ç”Ÿæˆåœ–ç‰‡
5. **AI é€šç”¨è®Šæ¸…æ™°** - åœ–åƒéŠ³åŒ–èˆ‡ç„¡ææ”¾å¤§
6. **AI åœ–ç‰‡ç¿»è­¯** - è­˜åˆ¥åœ–ç‰‡æ–‡å­—èˆ‡å¤šèªè¨€ç¿»è­¯

---

## âœ… å·²å®Œæˆå·¥ä½œ

### éšæ®µ 1: å°ˆæ¡ˆè¦åŠƒèˆ‡æ¶æ§‹è¨­è¨ˆ âœ…

- âœ… å®ŒæˆæŠ€è¡“æ¶æ§‹è¨­è¨ˆ
- âœ… åˆ¶å®šæ•¸æ“šåº« Schema
- âœ… è¦åŠƒ API ç«¯é»çµæ§‹
- âœ… å‰µå»ºå°ˆæ¡ˆæ–‡æª”

**è¼¸å‡ºæ–‡ä»¶ï¼š**
- `/home/ubuntu/website_analysis.md` - ç¶²ç«™åˆ†æå ±å‘Š

### éšæ®µ 2: æª¢æŸ¥ç¾æœ‰ç¶²ç«™çµæ§‹ä¸¦å…‹éš†å€‰åº« âœ…

- âœ… å…‹éš† GitHub å€‰åº«åˆ°æœ¬åœ°
- âœ… åˆ†æç¾æœ‰ç¶²ç«™çµæ§‹
- âœ… æª¢æŸ¥å®‰å…¨è­¦ç¤ºï¼ˆæœªç™¼ç¾æ˜é¡¯æ´©æ¼ï¼‰

**å€‰åº«ä½ç½®ï¼š**
- `/home/ubuntu/MRwang520a.github.io/`

### éšæ®µ 3: åˆå§‹åŒ–å¾Œç«¯å°ˆæ¡ˆä¸¦é…ç½®é–‹ç™¼ç’°å¢ƒ âœ…

- âœ… å‰µå»ºå¾Œç«¯å°ˆæ¡ˆçµæ§‹
- âœ… å®‰è£æ‰€æœ‰ä¾è³´åŒ…
- âœ… é…ç½® TypeScript
- âœ… è¨­ç½®é–‹ç™¼ç’°å¢ƒ

**æŠ€è¡“æ£§ï¼š**
- Express 5 + TypeScript
- tRPC 11ï¼ˆé¡å‹å®‰å…¨ APIï¼‰
- Drizzle ORM + SQLite
- Zodï¼ˆæ•¸æ“šé©—è­‰ï¼‰

**å°ˆæ¡ˆçµæ§‹ï¼š**
```
backend/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ routes/          # tRPC è·¯ç”±
â”‚   â”œâ”€â”€ db/              # æ•¸æ“šåº«é…ç½®
â”‚   â”œâ”€â”€ types/           # TypeScript é¡å‹
â”‚   â””â”€â”€ index.sqlite.ts  # æœå‹™å™¨å…¥å£
â”œâ”€â”€ data/                # SQLite æ•¸æ“šåº«æ–‡ä»¶
â”œâ”€â”€ .env                 # ç’°å¢ƒè®Šæ•¸
â””â”€â”€ package.json         # ä¾è³´é…ç½®
```

### éšæ®µ 4: è¨­è¨ˆä¸¦å¯¦ç¾æ•¸æ“šåº«æ¶æ§‹ âœ…

- âœ… å‰µå»º SQLite æ•¸æ“šåº«é…ç½®
- âœ… å®šç¾©å®Œæ•´çš„æ•¸æ“šåº« Schema
- âœ… åŸ·è¡Œæ•¸æ“šåº«é·ç§»
- âœ… å‰µå»ºåˆå§‹æ¸¬è©¦æ•¸æ“š

**æ•¸æ“šåº«è¡¨ï¼š**

1. **users** - ç”¨æˆ¶è¡¨
   - id, email, username, avatarUrl
   - oauthProvider, oauthId
   - createdAt, updatedAt

2. **tasks** - ä»»å‹™è¡¨
   - id, userId, taskType, status
   - inputImageUrl, outputImageUrl
   - parameters (JSON), errorMessage
   - createdAt, completedAt

3. **user_quotas** - ç”¨æˆ¶é…é¡è¡¨
   - id, userId, quotaType
   - totalQuota, usedQuota
   - resetAt, createdAt, updatedAt

**æ¸¬è©¦æ•¸æ“šï¼š**
- æ¸¬è©¦ç”¨æˆ¶ï¼štest@example.com
- åˆå§‹é…é¡ï¼šå„åŠŸèƒ½ 30-100 æ¬¡ä½¿ç”¨é¡åº¦

---

## ğŸ”§ å·²å¯¦ç¾çš„ API ç«¯é»

### èªè­‰ç›¸é—œ (auth.*)
- `auth.getProfile()` - ç²å–ç•¶å‰ç”¨æˆ¶ä¿¡æ¯
- `auth.logout()` - ç™»å‡º
- `auth.handleCallback()` - OAuth å›èª¿è™•ç†ï¼ˆå¾…å®Œå–„ï¼‰

### AI åŠŸèƒ½ (ai.*)
- `ai.matting({ imageUrl })` - AI è¬ç‰©æ‘³åœ–
- `ai.retouch({ imageUrl, options })` - AI ç”¢å“ç²¾ä¿®
- `ai.background({ imageUrl, prompt })` - AI èƒŒæ™¯åˆæˆ
- `ai.designer({ prompt, style })` - AI è¨­è¨ˆå¸«
- `ai.upscale({ imageUrl, scale })` - AI é€šç”¨è®Šæ¸…æ™°
- `ai.translate({ imageUrl, targetLang })` - AI åœ–ç‰‡ç¿»è­¯

### ä»»å‹™ç®¡ç† (task.*)
- `task.getById({ id })` - æ ¹æ“š ID ç²å–ä»»å‹™
- `task.listByUser({ limit, offset, taskType, status })` - ç²å–ç”¨æˆ¶ä»»å‹™åˆ—è¡¨
- `task.cancel({ id })` - å–æ¶ˆä»»å‹™

### é…é¡ç®¡ç† (quota.*)
- `quota.getRemaining({ quotaType })` - ç²å–å‰©é¤˜é…é¡
- `quota.consume({ quotaType, amount })` - æ¶ˆè€—é…é¡

---

## ğŸš€ å¦‚ä½•é‹è¡Œ

### 1. å®‰è£ä¾è³´
```bash
cd /home/ubuntu/MRwang520a.github.io/backend
pnpm install
```

### 2. åˆå§‹åŒ–æ•¸æ“šåº«
```bash
# å‰µå»ºæ•¸æ“šåº«è¡¨
pnpm db:push --config=drizzle.config.sqlite.ts

# å¡«å……æ¸¬è©¦æ•¸æ“š
pnpm db:seed
```

### 3. å•Ÿå‹•é–‹ç™¼æœå‹™å™¨
```bash
pnpm dev
```

æœå‹™å™¨å°‡åœ¨ `http://localhost:3000` å•Ÿå‹•ã€‚

### 4. æ¸¬è©¦ API
```bash
# å¥åº·æª¢æŸ¥
curl http://localhost:3000/health

# tRPC ç«¯é»
curl http://localhost:3000/trpc
```

---

## ğŸ“Š ç•¶å‰é€²åº¦

| éšæ®µ | ç‹€æ…‹ | å®Œæˆåº¦ |
|------|------|--------|
| 1. å°ˆæ¡ˆè¦åŠƒèˆ‡æ¶æ§‹è¨­è¨ˆ | âœ… å®Œæˆ | 100% |
| 2. æª¢æŸ¥ç¾æœ‰ç¶²ç«™çµæ§‹ä¸¦å…‹éš†å€‰åº« | âœ… å®Œæˆ | 100% |
| 3. åˆå§‹åŒ–å¾Œç«¯å°ˆæ¡ˆä¸¦é…ç½®é–‹ç™¼ç’°å¢ƒ | âœ… å®Œæˆ | 100% |
| 4. è¨­è¨ˆä¸¦å¯¦ç¾æ•¸æ“šåº«æ¶æ§‹ | âœ… å®Œæˆ | 100% |
| 5. å¯¦ç¾ Manus OAuth èªè­‰ç³»çµ± | â³ å¾…é–‹å§‹ | 0% |
| 6. å»ºç«‹ tRPC API ç«¯é»èˆ‡ AI æœå‹™æ•´åˆ | â³ å¾…é–‹å§‹ | 0% |
| 7. é–‹ç™¼å‰ç«¯é é¢èˆ‡åŠŸèƒ½æ¨¡çµ„ | â³ å¾…é–‹å§‹ | 0% |
| 8. éƒ¨ç½²èˆ‡æ¸¬è©¦é©—è­‰ | â³ å¾…é–‹å§‹ | 0% |
| 9. å‘ç”¨æˆ¶äº¤ä»˜æˆæœèˆ‡æ–‡æª” | â³ å¾…é–‹å§‹ | 0% |

**ç¸½é«”é€²åº¦ï¼š44% (4/9 éšæ®µå®Œæˆ)**

---

## ğŸ¯ ä¸‹ä¸€æ­¥è¨ˆåŠƒ

### éšæ®µ 5: å¯¦ç¾ Manus OAuth èªè­‰ç³»çµ±

éœ€è¦å®Œæˆï¼š
1. æ•´åˆ Manus OAuth æµç¨‹
2. å¯¦ç¾ç™»å…¥/ç™»å‡ºåŠŸèƒ½
3. å»ºç«‹æœƒè©±ç®¡ç†
4. ä¿è­· API ç«¯é»

### éšæ®µ 6: å»ºç«‹ tRPC API ç«¯é»èˆ‡ AI æœå‹™æ•´åˆ

éœ€è¦å®Œæˆï¼š
1. æ•´åˆå…§å»ºçš„åœ–ç‰‡ç”Ÿæˆ API
2. å¯¦ç¾å…­å€‹ AI åŠŸèƒ½çš„å¯¦éš›é‚è¼¯
3. å»ºç«‹ä»»å‹™éšŠåˆ—ç³»çµ±
4. å¯¦ç¾åœ–ç‰‡ä¸Šå‚³åŠŸèƒ½

### éšæ®µ 7: é–‹ç™¼å‰ç«¯é é¢èˆ‡åŠŸèƒ½æ¨¡çµ„

éœ€è¦å®Œæˆï¼š
1. åœ¨é¦–é æ·»åŠ å…­å€‹åŠŸèƒ½å…¥å£
2. å‰µå»ºå…­å€‹åŠŸèƒ½å­é é¢
3. å¯¦ç¾åœ–ç‰‡ä¸Šå‚³å’Œçµæœå±•ç¤º
4. æ•´åˆ tRPC å®¢æˆ¶ç«¯

---

## ğŸ“ é‡è¦æ–‡ä»¶ä½ç½®

### å¾Œç«¯å°ˆæ¡ˆ
- **ä¸»å…¥å£**: `/home/ubuntu/MRwang520a.github.io/backend/src/index.sqlite.ts`
- **è·¯ç”±å®šç¾©**: `/home/ubuntu/MRwang520a.github.io/backend/src/routes/`
- **æ•¸æ“šåº«é…ç½®**: `/home/ubuntu/MRwang520a.github.io/backend/src/db/config.sqlite.ts`
- **Schema å®šç¾©**: `/home/ubuntu/MRwang520a.github.io/backend/src/db/schema.sqlite.ts`
- **ç’°å¢ƒè®Šæ•¸**: `/home/ubuntu/MRwang520a.github.io/backend/.env`

### å‰ç«¯å°ˆæ¡ˆ
- **ä¸»é é¢**: `/home/ubuntu/MRwang520a.github.io/index.html`

### æ–‡æª”
- **å°ˆæ¡ˆç¸½çµ**: `/home/ubuntu/MRwang520a.github.io/PROJECT_SUMMARY.md`
- **ç¶²ç«™åˆ†æ**: `/home/ubuntu/website_analysis.md`
- **å¾Œç«¯ README**: `/home/ubuntu/MRwang520a.github.io/backend/README.md`

---

## ğŸ”‘ ç’°å¢ƒè®Šæ•¸é…ç½®

éœ€è¦é…ç½®çš„ç’°å¢ƒè®Šæ•¸ï¼ˆåœ¨ `.env` æ–‡ä»¶ä¸­ï¼‰ï¼š

```env
# æœå‹™å™¨é…ç½®
PORT=3000
NODE_ENV=development

# Manus OAuthï¼ˆéœ€è¦ç”¨æˆ¶æä¾›ï¼‰
MANUS_CLIENT_ID=
MANUS_CLIENT_SECRET=
MANUS_REDIRECT_URI=http://localhost:3000/auth/callback

# AI æœå‹™ï¼ˆå·²è‡ªå‹•ç¹¼æ‰¿ï¼‰
OPENAI_API_KEY=${OPENAI_API_KEY}

# Session å¯†é‘°
SESSION_SECRET=dev_secret_key_change_in_production

# CORS é…ç½®
ALLOWED_ORIGINS=http://localhost:3000,https://mrwang520a.github.io
```

---

## ğŸ›  å¯ç”¨çš„ npm è…³æœ¬

```bash
# é–‹ç™¼
pnpm dev                # å•Ÿå‹•é–‹ç™¼æœå‹™å™¨ï¼ˆç†±é‡è¼‰ï¼‰

# æ§‹å»º
pnpm build              # æ§‹å»ºç”Ÿç”¢ç‰ˆæœ¬
pnpm start              # é‹è¡Œç”Ÿç”¢ç‰ˆæœ¬

# æ•¸æ“šåº«
pnpm db:generate        # ç”Ÿæˆæ•¸æ“šåº«é·ç§»
pnpm db:push            # æ¨é€åˆ°æ•¸æ“šåº«
pnpm db:studio          # æ‰“é–‹æ•¸æ“šåº«å¯è¦–åŒ–å·¥å…·
pnpm db:seed            # å¡«å……æ¸¬è©¦æ•¸æ“š
```

---

## ğŸ“ å¾…å¯¦ç¾åŠŸèƒ½

- [ ] Manus OAuth å®Œæ•´å¯¦ç¾
- [ ] AI æœå‹™å¯¦éš›å°æ¥
- [ ] åœ–ç‰‡ä¸Šå‚³åŠŸèƒ½
- [ ] ä»»å‹™éšŠåˆ—ç³»çµ±
- [ ] é€Ÿç‡é™åˆ¶
- [ ] æ—¥èªŒç³»çµ±
- [ ] å–®å…ƒæ¸¬è©¦
- [ ] å‰ç«¯é é¢é–‹ç™¼
- [ ] éƒ¨ç½²é…ç½®

---

## ğŸ“ æŠ€è¡“äº®é»

1. **é¡å‹å®‰å…¨**: ä½¿ç”¨ tRPC å¯¦ç¾ç«¯åˆ°ç«¯é¡å‹å®‰å…¨
2. **ç¾ä»£ ORM**: ä½¿ç”¨ Drizzle ORMï¼Œé¡å‹å®‰å…¨ä¸”æ€§èƒ½å„ªç•°
3. **æ¨¡çµ„åŒ–è¨­è¨ˆ**: æ¸…æ™°çš„å°ˆæ¡ˆçµæ§‹ï¼Œæ˜“æ–¼ç¶­è­·å’Œæ“´å±•
4. **é–‹ç™¼é«”é©—**: ç†±é‡è¼‰ã€TypeScript åš´æ ¼æ¨¡å¼
5. **æ•¸æ“šåº«å¯è¦–åŒ–**: å…§å»º Drizzle Studio

---

## ğŸ“ è¯ç¹«æ–¹å¼

å¦‚æœ‰å•é¡Œï¼Œè«‹è¯ç¹«å°ˆæ¡ˆç¶­è­·è€…ã€‚

---

**æœ€å¾Œæ›´æ–°**: 2025-10-25
**ç‰ˆæœ¬**: 0.4.0 (éšæ®µ 4 å®Œæˆ)

